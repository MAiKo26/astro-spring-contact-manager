---
import Layout from "../../layouts/Layout.astro";
export const getStaticPaths = async () => {
  const response = await fetch("http://localhost:8080/contacts");
  const data = await response.json();
  return data.content.map(({id}) => {
    const slug = id;
    return {
      params: {slug},
    };
  });
};

const {slug} = Astro.params;
const response = await fetch("http://localhost:8080/contacts/" + slug);
const contact = await response.json();
---

<Layout>
  <a href="/" class="btn">&lt;= Go back</a>

  <div class="profile">
    <div class="profile__details">
      <img src={contact.photoUrl} alt={`Profile photo of ${contact.name}`} />
      <div class="profile__metadata">
        <p class="profile__name">{contact.name}</p>
        <p class="profile__muted">JPG, GIF, or PNG. Max size of 10MG</p>
        <button class="btn"
          ><i class="bi bi-cloud-upload"></i> Change Photo</button
        >
      </div>
    </div>
    <div class="profile__settings">
      <div>
        <form class="form">
          <div class="user-details">
            <input type="hidden" value={contact.id} name="id" required />
            <div class="input-box">
              <span class="details">Name</span>
              <input type="text" value={contact.name} name="name" required />
            </div>
            <div class="input-box">
              <span class="details">Email</span>
              <input type="text" value={contact.email} name="email" required />
            </div>
            <div class="input-box">
              <span class="details">Phone</span>
              <input type="text" value={contact.phone} name="phone" required />
            </div>
            <div class="input-box">
              <span class="details">Address</span>
              <input
                type="text"
                value={contact.address}
                name="address"
                required
              />
            </div>
            <div class="input-box">
              <span class="details">Title</span>
              <input type="text" value={contact.title} name="title" required />
            </div>
            <div class="input-box">
              <span class="details">Status</span>
              <input
                type="text"
                value={contact.status}
                name="status"
                required
              />
            </div>
          </div>
          <div class="form_footer">
            <button type="submit" class="btn">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <form style={{display: "none"}}>
    <input type="file" name="file" accept="image/*" />
  </form>
</Layout>
